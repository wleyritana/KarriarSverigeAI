<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ t.app_title }}</title>
<link rel="stylesheet" href="/static/styles.css">
</head>
<body><div class="container">
<h1>{{ t.app_title }}</h1>

{% if error %}
  <div class="error-box">
    <strong>Could not extract job posting from URL.</strong>
    <div class="small">{{ error }}</div>
    <p class="small">
      Some job boards block scraping or require JavaScript rendering. Try a company careers page or an ATS-hosted posting (Greenhouse/Lever).
    </p>
  </div>

  {% if preview %}
    <details class="preview">
      <summary>Show extracted preview (debug)</summary>
      <div class="small">Status: {{ preview.status_code }} | Final URL: {{ preview.final_url }} | Extracted chars: {{ preview.text_length }}</div>
      <pre class="code">{{ preview.text[:2000] }}</pre>
    </details>
  {% endif %}

  <div class="fallback">
    <p class="small"><strong>Fallback:</strong> Paste the job description text below and run again.</p>
  </div>
{% endif %}

<form method="POST" action="/run">
<textarea name="cv" placeholder="{{ t.cv_label }}"></textarea>
<input type="url" name="job_url" placeholder="{{ t.job_label }}" value="{{ job_url or '' }}" required>

{% if error %}
<textarea name="job_text_fallback" placeholder="Paste job description here (fallback)" rows="8"></textarea>
{% endif %}

<input name="role" placeholder="{{ t.role_label }}">
<input name="company" placeholder="{{ t.company_label }}">
<textarea name="culture" placeholder="{{ t.culture_label }}"></textarea>
<textarea name="reviews" placeholder="{{ t.reviews_label }}"></textarea>

<label>{{ t.language_label }}</label>
<select name="lang">
<option value="sv" {% if lang=="sv" %}selected{% endif %}>Svenska</option>
<option value="en" {% if lang=="en" %}selected{% endif %}>English</option>
</select>

<button type="submit">{{ t.run_analysis }}</button>
</form></div>
</body>
</html>
